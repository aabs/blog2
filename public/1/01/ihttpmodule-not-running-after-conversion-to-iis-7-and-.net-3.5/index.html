<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
  IHttpModule not running after conversion to IIS 7 and .NET 3.5 · The Wandering Glitch
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="description" content="I recently ran into this problem with one of our clients. It&rsquo;s the sort of thing that I take ages to track down a solution to, and then once I have solved it, I immediately forget what the solution is. So I&rsquo;m putting it here as an aid memoire.
The client had a module that they were using to create a custom Principal object derived from a FormsPrincipal. I found that after I had converted the project to work with VS.">
<meta name="keywords" content="">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="IHttpModule not running after conversion to IIS 7 and .NET 3.5"/>
<meta name="twitter:description" content="I recently ran into this problem with one of our clients. It&rsquo;s the sort of thing that I take ages to track down a solution to, and then once I have solved it, I immediately forget what the solution is. So I&rsquo;m putting it here as an aid memoire.
The client had a module that they were using to create a custom Principal object derived from a FormsPrincipal. I found that after I had converted the project to work with VS."/>

<meta property="og:title" content="IHttpModule not running after conversion to IIS 7 and .NET 3.5" />
<meta property="og:description" content="I recently ran into this problem with one of our clients. It&rsquo;s the sort of thing that I take ages to track down a solution to, and then once I have solved it, I immediately forget what the solution is. So I&rsquo;m putting it here as an aid memoire.
The client had a module that they were using to create a custom Principal object derived from a FormsPrincipal. I found that after I had converted the project to work with VS." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://industrialinference.com/1/01/ihttpmodule-not-running-after-conversion-to-iis-7-and-.net-3.5/" /><meta property="article:section" content="posts" />






<link rel="canonical" href="https://industrialinference.com/1/01/ihttpmodule-not-running-after-conversion-to-iis-7-and-.net-3.5/">


<link rel="preload" href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.7f9d180e3b3bebba9ba80d55eed1255c35e00764872854736d6ad7db38884ffc.css" integrity="sha256-f50YDjs767qbqA1V7tElXDXgB2SHKFRzbWrX2ziIT/w=" crossorigin="anonymous" media="screen" />








 




<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">




<meta name="generator" content="Hugo 0.108.0">





  </head>




<body class="preload-transitions colorscheme-light">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      The Wandering Glitch
    </a>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://industrialinference.com/1/01/ihttpmodule-not-running-after-conversion-to-iis-7-and-.net-3.5/">
              IHttpModule not running after conversion to IIS 7 and .NET 3.5
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="0001-01-01T00:00:00Z">
                January 1, 0001
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              2-minute read
            </span>
          </div>
          
          
          
        </div>
      </header>

      <div>
        
        <p>I recently ran into this problem with one of our clients. It&rsquo;s the sort of thing that I take ages to track down a solution to, and then once I have solved it, I immediately forget what the solution is. So I&rsquo;m putting it here as an aid memoire.</p>
<p>The client had a module that they were using to create a custom Principal object derived from a FormsPrincipal. I found that after I had converted the project to work with VS.NET 2008 beta 2, it stopped working, giving me a GenericPrincipal instead. I had converted the client&rsquo;s project to .NET 3.5 from .NET 2.0 and I was also using IIS 7 where they were using IIS 6 in production and IIS 5 for dev. There were a few variables that made it not very straightforward to solve, not least of which is that nothing is easy to find in IIS 7 (when you&rsquo;re so used to IIS 6).</p>
<p>First step: find the blasted thing that shows you what managed modules you&rsquo;ve got.</p>
<p><a href="%7Bstatic%7D2007/11/image.png"><img src="%7Bstatic%7D2007/11/image-thumb.png" alt="image">{width=&ldquo;239&rdquo; height=&ldquo;355&rdquo;}</a></p>
<p>Double click on it, and you will be shown a list of what modules apply for the application you&rsquo;re working with.</p>
<p>Sort the modules by type.</p>
<p><a href="%7Bstatic%7D2007/11/image1.png"><img src="%7Bstatic%7D2007/11/image-thumb1.png" alt="image">{width=&ldquo;213&rdquo; height=&ldquo;132&rdquo;}</a></p>
<p>What I found was that my web.config file had entries for two modules:</p>
<p><a href="%7Bstatic%7D2007/11/image2.png"><img src="%7Bstatic%7D2007/11/image-thumb2.png" alt="image">{width=&ldquo;314&rdquo; height=&ldquo;94&rdquo;}</a></p>
<p>But IIS 7 claimed I had only one.</p>
<p><a href="%7Bstatic%7D2007/11/image3.png"><img src="%7Bstatic%7D2007/11/image-thumb3.png" alt="image">{width=&ldquo;363&rdquo; height=&ldquo;47&rdquo;}</a></p>
<p>I tried a load of different things, like rearranging the order of the modules, putting tracing on the lifecycle events of the module, and adding more detailed version info on the fully qualified type name of the module. All to no avail. Then I noticed that IIS offered the ability to add you own modules.</p>
<p><a href="%7Bstatic%7D2007/11/image4.png"><img src="%7Bstatic%7D2007/11/image-thumb4.png" alt="image">{width=&ldquo;178&rdquo; height=&ldquo;135&rdquo;}</a></p>
<p>So I clicked on the &ldquo;Add Managed Module&hellip;&rdquo; link, and entered the details that were already in the web.config file, and hey presto! It replaced the contents of the modules section in the web.config with exactly the same data. But this time it was also reflected in the modules area of IIS 7.</p>
<p><a href="%7Bstatic%7D2007/11/image5.png"><img src="%7Bstatic%7D2007/11/image-thumb5.png" alt="image">{width=&ldquo;354&rdquo; height=&ldquo;63&rdquo;}</a></p>
<p>Don&rsquo;t ask me why - it&rsquo;s probably something to do with the IIS 7 metabase, but I don&rsquo;t know. Certainly, it wasn&rsquo;t anything wrong with the config file.</p>

      </div>


      <footer>
        


        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2022
    
    ·
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.27afce394fb6284f521b3fbc9f6a8326342333c3092267f3944d770489876fed.js" integrity="sha256-J6/OOU&#43;2KE9SGz&#43;8n2qDJjQjM8MJImfzlE13BImHb&#43;0="></script>
  

  

  

  

  

  

  

  

  

  
</body>

</html>
