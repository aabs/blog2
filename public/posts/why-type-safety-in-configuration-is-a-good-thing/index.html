<!DOCTYPE html>
<html lang="en-au">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Why type safety in configuration is a good thing | The Wandering Glitch</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="How many times have you seen a piece of code like this?
bool shouldUseXyzService = bool.Parse(WebConfiguration.AppSettings[&quot;shouldUseXyzService&quot;]); if(shouldUseXyzService){…}
It&rsquo;s a familiar thing to most programmers. And most programmers never stop to think about just how evil it is. In my last few posts I&rsquo;ve been suggesting that we ought to be using something like this:
if(SomeConfiguration.ShouldUseXyzService){…}
Why is it better?
Type Safety. The key reason is automatic type safety. Type safety ensures that when you make a call to another component you get the data you are after in the format you wanted.">
    <meta name="generator" content="Hugo 0.92.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
    <meta property="og:title" content="Why type safety in configuration is a good thing" />
<meta property="og:description" content="How many times have you seen a piece of code like this?
bool shouldUseXyzService = bool.Parse(WebConfiguration.AppSettings[&quot;shouldUseXyzService&quot;]); if(shouldUseXyzService){…}
It&rsquo;s a familiar thing to most programmers. And most programmers never stop to think about just how evil it is. In my last few posts I&rsquo;ve been suggesting that we ought to be using something like this:
if(SomeConfiguration.ShouldUseXyzService){…}
Why is it better?
Type Safety. The key reason is automatic type safety. Type safety ensures that when you make a call to another component you get the data you are after in the format you wanted." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://45.89.107.9/posts/why-type-safety-in-configuration-is-a-good-thing/" /><meta property="article:section" content="posts" />



<meta itemprop="name" content="Why type safety in configuration is a good thing">
<meta itemprop="description" content="How many times have you seen a piece of code like this?
bool shouldUseXyzService = bool.Parse(WebConfiguration.AppSettings[&quot;shouldUseXyzService&quot;]); if(shouldUseXyzService){…}
It&rsquo;s a familiar thing to most programmers. And most programmers never stop to think about just how evil it is. In my last few posts I&rsquo;ve been suggesting that we ought to be using something like this:
if(SomeConfiguration.ShouldUseXyzService){…}
Why is it better?
Type Safety. The key reason is automatic type safety. Type safety ensures that when you make a call to another component you get the data you are after in the format you wanted.">

<meta itemprop="wordCount" content="684">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Why type safety in configuration is a good thing"/>
<meta name="twitter:description" content="How many times have you seen a piece of code like this?
bool shouldUseXyzService = bool.Parse(WebConfiguration.AppSettings[&quot;shouldUseXyzService&quot;]); if(shouldUseXyzService){…}
It&rsquo;s a familiar thing to most programmers. And most programmers never stop to think about just how evil it is. In my last few posts I&rsquo;ve been suggesting that we ought to be using something like this:
if(SomeConfiguration.ShouldUseXyzService){…}
Why is it better?
Type Safety. The key reason is automatic type safety. Type safety ensures that when you make a call to another component you get the data you are after in the format you wanted."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        The Wandering Glitch
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/posts/" title="Posts page">
              Posts
            </a>
          </li>
          
        </ul>
      
      
<div class="ananke-socials">
  
    
    <a href="https://techhub.social/@aabs" target="_blank" rel="me noopener" class="mastodon ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Mastodon link" aria-label="follow on Mastodon——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 230 230;" version="1.1" viewBox="0 0 230 230"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125 0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875 0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433 0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09 0 0 32.97625 14.7525 32.97625 65.0825 0 0 .4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd;"/>
<path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375 0-16.32-7.3075-16.32-16.32125 0-9.01375 7.30625-16.3225 16.32-16.3225 9.015 0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125-9.01375 0-16.32125-7.3075-16.32125-16.32125 0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375 0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125-9.01375 0-16.32125-7.3075-16.32125-16.32125 0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375 0 16.32125 7.30875 16.32125 16.3225" fill="#fff"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Why type safety in configuration is a good thing</h1>
      
      <p class="tracked">
        By <strong>Andrew Matthews</strong>
      </p>
      
      
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links #000000 pr4-l w-two-thirds-l"><p>How many times have you seen a piece of code like this?</p>
<p><code>bool shouldUseXyzService = bool.Parse(WebConfiguration.AppSettings[&quot;shouldUseXyzService&quot;]); if(shouldUseXyzService){…}</code></p>
<p>It&rsquo;s a familiar thing to most programmers. And most programmers never stop to think about just how evil it is. In my last few posts I&rsquo;ve been suggesting that we ought to be using something like this:</p>
<p><code>if(SomeConfiguration.ShouldUseXyzService){…}</code></p>
<p>Why is it better?</p>
<h5 id="type-safety">Type Safety.</h5>
<p>The key reason is automatic type safety. Type safety ensures that when you make a call to another component you get the data you are after in the format you wanted. Imagine if you had to check for &lsquo;y&rsquo;, &lsquo;yes&rsquo;, &lsquo;true&rsquo;, &lsquo;1&rsquo; and so on. It wouldn&rsquo;t take you long before you started making sure that you had a single representation of true. And that&rsquo;s what type safety ensures in the case of a config system.</p>
<p>There is another form of type safety at stake. The config data might be in the wrong format. You code ought to have looked like this:</p>
<p><code>try{    bool shouldUseXyzService = bool.Parse(WebConfiguration.AppSettings[&quot;shouldUseXyzService&quot;] .Trim().ToLower());    if(shouldUseXyzService){…} }catch(FormatException e){…}</code></p>
<p>What do you do if the config is in the wrong format? Rethrow? Set a default value? Rethrowing means your app is toast. Setting a default value will yield unpredictable behavior, especially when the config files are different between production and release builds. You never have this kind of production weirdness with typed configuration objects because that sort of syntactic error never makes it through a compilation.</p>
<h5 id="performance">Performance</h5>
<p>Unless you have a mechanism to load a cache the contents of the configuration file in memory, you are inevitably going to have to make a file access every time you access the config variable. With most built-in config systems, you will get that for free. But most config files are stored in a name value dictionary format of some sort – a hash table. Accessing a hashtable every time you want to get at a variable is very expensive compared to the kind of inlined access you would get if you were accessing a const or read-only variable on an abstract type.</p>
<p>A built in config system (such as the one found in .NET) is not going to know what type your data is in, so it can&rsquo;t store a typed representation of the data for fast access. Instead it will store the data in a string. That means that you have to parse your data every time you access it. In the case of a bool above it might be reasonably straightforward to parse it, but your still talking about a lot of CPU cycles wasted for no advantage. Imagine if your config was a date time or currency value that had a lot of logic required to convert into local specific object representations. In those cases the simplicity of the .Parse(…) API hides a major time waster.</p>
<h5 id="no-test-guarantees">No test guarantees</h5>
<p>When you run a set of tests over a piece of code – it gives you an assurance that the code works. You can deploy it to production and it will behave in the same way there. When you have a set of guiding policy variables that are not part of the test regime you are already losing some of the safety that you have with fully tested code.</p>
<h5 id="readability">Readability</h5>
<p>I doubt that there would be any debate that the typed configuration object code above is more readable than the first or second untyped examples. The intent is clear, the format is understood by the runtime and it gets intellisense support. The typed configuration object has another level of readability. If you put a whole bunch of related configurations together in a class called XyzServiceConfigurations it is much easier for developers to know where to go to get a specific setting. I&rsquo;ve seen a few systems that define a Constants class, but generally these classes are not broken up into semantically meaningful units. Why? I don&rsquo;t know. We can go further by defining relationships between config objects we can dispense them in consistent ways using class factories.</p>
<p>Designers should really be looking for justifications for untyped config systems, not the reverse.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://45.89.107.9/" >
    &copy;  The Wandering Glitch 2022 
  </a>
    <div>
<div class="ananke-socials">
  
    
    <a href="https://techhub.social/@aabs" target="_blank" rel="me noopener" class="mastodon ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Mastodon link" aria-label="follow on Mastodon——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 230 230;" version="1.1" viewBox="0 0 230 230"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125 0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875 0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433 0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09 0 0 32.97625 14.7525 32.97625 65.0825 0 0 .4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd;"/>
<path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375 0-16.32-7.3075-16.32-16.32125 0-9.01375 7.30625-16.3225 16.32-16.3225 9.015 0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125-9.01375 0-16.32125-7.3075-16.32125-16.32125 0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375 0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125-9.01375 0-16.32125-7.3075-16.32125-16.32125 0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375 0 16.32125 7.30875 16.32125 16.3225" fill="#fff"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
